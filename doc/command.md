
## <a id="vimcmd"><font color="red">Vim 命令</font></a>
我们常说的命令通常是指在正常模式下的操作。

技术链接：  
[Vim命令合集](http://www.cnblogs.com/softwaretesting/archive/2011/07/12/2104435.html)     
[一些不起眼但非常有用的 Vim 命令](http://blog.jobbole.com/84683/)   


> 以:和/开头的命令都有历史纪录，按上下箭头来选择某个历史命令。

### <a id="startvim">启动 Vim</a>

    vim -c cmd file                         在打开文件前，先执行指定的命令。例如：vim -c "set nonu" file1
    vim -r                                  列出交换文件并退出。
    vim -r file                             恢复崩溃的会话。                 
    vim -R file                             只读模式，可以强制保存。
    vim -m file                             不可修改(写入文件)。
    vim -M file                             文本不可修改。    
    vim -y file                             容易模式。
    vim + file                              启动后跳到文件末尾。
    vim +lnum file                          启动后跳到第 <lnum> 行。
    vim +/string file                       打开file，并将光标停留在第一个找到的string行上。

### <a id="vimcmd_file">文件命令</a>
#### <a id="openfle">1. 打开文件</a>

    vim file                                打开单个文件
    vim file1 file2 file3 ...               同时打开多个文件
    
#### <a id="basefile">2. 基本文件操作</a>

    :open file                              在vim窗口中打开一个新文件
    :split file                             在水平分割的窗口中打开文件
    :vsplit file                            在垂直分割的窗口中打开文件
    :e file                                 关闭当前编辑的文件，并开启新的文件，如果对当前文件的修改未保存，vi会警告。
    :e! file                                放弃对当前文件的修改，编辑新的文件
    :e + file                               开始新的文件，并从文件尾开始编辑。
    :e +n file                              开始新的文件，并从文件第n行开始编辑。
    :e new                                  编译一个未命名的新文档。(<ctrl-w> + n)
    :e                                      重新加载当前文档。
    :e!                                     重新加载当前文档，并丢弃已做的改动。
    :e#(ctrl+^)                             回到刚才编辑的文件。
    :f(ctrl+g)                              显示文档名、是否修改和光标位置。
    :f filename                             改变编辑的文件名，这时保存相当于另存为。
    :n1,n2w filename                        将n1到n2的内容保存到 filename 文件中。
    :saveas newfilename                     另存为到文件 newfilename 中。
    :args                                   查看当前打开的文件列表，当前正在编辑的文件会用[]括起来。
    :e ftp://192.168.10.76/abc.txt          打开远程文件。
    :bn 切换到下一个文件
    :bp 切换到上一个文件
    :Sex                                    水平分割一个窗口，浏览文件系统。
    :Vex                                    垂直分割一个窗口，浏览文件系统。
    
    gf                                      打开以光标所在字符串为文件名的文件。
       
#### <a id="insertall">3. 插入另一个文件的全部内容</a>
打开文件b.txt，将光标定位到要复制插入的位置，然后进入命令模式中输入：
    
    :r!cat a.txt

#### <a id="insertparts">4. 插入另一个文件的部分内容</a>
打开一个文件a.txt,复制n+1行:
    
        "ayn+1
然后敲命令转到文件b.txt:
        
        :ex b.txt

敲命令:
        
        "ap


### <a id="vimcmd_insert">插入命令</a>

    i 在当前位置生前插入
    a 在当前位置后插入
    I 在当前行首插入
    A 在当前行尾插入
    o 在当前行之后插入一行
    O 在当前行之前插入一行

查看当前打开的文件列表，当前正在编辑的文件会用[]括起来。

:args

### <a id="vimcmd_move">移动命令</a>
> 在Vim中，很多命令都可以配合数字使用，比如删除10个字符10x，在当前位置后插入3个！，3a！<Esc>，这里的Esc是必须的，否则命令不生效。

    h 左移一个字符
    l 右移一个字符
    k 上移一个字符
    j 下移一个字符
> 以上四个命令可以配合数字使用，比如20j就是向下移动20行，5h就是向左移动5个字符。

    w 向前移动一个单词, 光标停在单词首部
    b 向后移动一个单词, 光标停在单词首部
    e 向前移动一个单词，光标停在单词尾部
    ge 向后移动一个单词，光标停在单词尾部
    
    ^ 移动到本行第一个非空白字符上。
    0 移动到本行第一个字符上，
    <HOME> 移动到本行第一个字符。同0健。
    $ 移动到行尾 
    3$ 移动到下面3行的行尾
    
    gg 移动到文件头。([[)
    G 移动到文件尾。 (]])
> f（find）命令也可以用于移动，fx将找到光标后第一个为x的字符，3fd将找到第三个为d的字符。F 同f，反向查找。

    :n 跳到指定行
    nG 跳到指定行

    Ctrl + e 向下滚动一行
    Ctrl + y 向上滚动一行
    Ctrl + d 向下滚动半屏
    Ctrl + u 向上滚动半屏
    Ctrl + f 向下滚动一屏
    Ctrl + b 向上滚动一屏

### <a id="vimcmd_delete">删除命令</a>

        x： 删除当前字符
        nx： 删除当前光标开始向后 n 个字符
        X： 删除当前字符的前一个字符    
        D： 删除当前字符至行尾。

        dl： 删除当前字符 (dl=x)
        dh： 删除前一个字符 (dh=X)
        d$：删除当前字符至行尾(d$=D)

        dd： 删除当前行
        dj： 删除本行及下一行
        dk： 删除本行及上一行

        10d： 删除当前行及下面的10行。

        kdgg： 删除当前行之前所有行（不包括当前行）
        jdG：删除当前行之后所有行（不包括当前行）

        :1,10d 删除1-10行
        :11,$d 删除11行及以后所有的行
        :1,$d 删除所有行

        J: 删除两行之间的空行，实际上是合并两行。


### <a id="vimcmd_yank">拷贝和粘贴</a>

        yy(Y) 拷贝当前行
        nyy 拷贝当前后开始的n行，比如2yy拷贝当前行及其下一行。
        y^ 复制至行首，或y0。不含游标所在处字元。 
        y$ 复制至行尾。含游标所在处字元。 
        yw 复制一个word。 
        y2w 复制两个字（单词）。 
        yG 复制至档尾。 
        y1G 复制至档首。   
        "14yl 从光标处开始复制光标后的 4 个字符。（"110yl 后面10个字符，指定粘贴板为"1 引号不能少）
        "14yh 从光标处开始复制光标前的 4 个字符。
        "1v 进入visual方式，然后就可以移动方向键选中文本，然后按y，就拷贝完成至指定粘贴板
        p  在当前光标后粘贴,如果之前使用了yy命令来复制一行，那么就在当前行的下一行粘贴。
        shift+p 在当前行前粘贴

        :1,10 co 20 将1-10行拷贝到第20行之后。
        :1,$ co $ 将整个文件复制一份并添加到文件尾部。

        ddp交换当前行和其下一行
        xp交换当前字符和其后一个字符

> 正常模式下按v（逐字）或V（逐行）进入可视模式，然后用jklh命令移动即可选择某些行或字符，再按y即可复制

小技巧

     %（跳转到与之匹配的括号处）
     .（重复上次的修改命令）
     `.（跳转到最近修改过的位置）
     ZQ（无条件退出）
     ZZ（存盘退出）
     ga（显示光标下的字符在当前使用的 encoding 下的内码）
     guw（光标下的单词变为小写）
     gUw（光标下的单词变为大写）
     :TOhtml（根据 Vim 的语法加亮的方式生成 HTML 代码；在图形界面中也可以使用菜单“Syntax—Convert to HTML”达到同样效果

## <a id="vimcmd_jump">跳转命令</a>

    Ctrl + O 跳转到光标的上次位置
    Ctrl + I 跳转到光标的下次位置

### <a id="vimcmd_undo">撤销和重做</a>

    u 撤销（Undo）
    U 撤销对整行的操作
    Ctrl + r 重做（Redo），即撤销的撤销。
    

## <a id="vimcmd_exit">退出命令</a>

    :wq 保存并退出
    :x 同wq
    ZZ 保存并退出
    :q! 强制退出并忽略所有更改
    :e! 放弃所有修改，并打开原来文件。


### <a id="vimcmd_replace">替换</a>
vi/vim 中可以使用 :s 命令来替换字符串

    :s/vivian/sky/ 替换当前行第一个 vivian 为 sky
    :s/vivian/sky/g 替换当前行所有 vivian 为 sky
    :n,$s/vivian/sky/ 替换第 n 行开始到最后一行中每一行的第一个 vivian 为 sky
    :n,$s/vivian/sky/g 替换第 n 行开始到最后一行中每一行所有 vivian 为 sky(n 为数字，若 n 为 .，表示从当前行开始到最后一行)
    :%s/vivian/sky/（等同于 :g/vivian/s//sky/） 替换每一行的第一个 vivian 为 sky
    :%s/vivian/sky/g（等同于 :g/vivian/s//sky/g） 替换每一行中所有 vivian 为 sky

可以使用 # 作为分隔符，此时中间出现的 / 不会作为分隔符

    :s#vivian/#sky/# 替换当前行第一个 vivian/ 为 sky/
    :%s+/oradata/apras/+/user01/apras1+ （使用+ 来 替换 / ）： /oradata/apras/替换成/user01/apras1/

替换单个字符

    将光标移到要替换的字符上：
    rx x为要替换后的字符
    
### <a id="vimcmd_comment">注释</a>

    3,5 s/^/#/g 注释第3-5行
    3,5 s/^#//g 解除3-5行的注释
    1,$ s/^/#/g 注释整个文档。
    :%s/^/#/g 注释整个文档，此法更快。


### <a id="vimcmd_indent">批量缩进</a>

* 按下 v 键进入可视模式，选中要缩进的代码：       

          按下 n< 向前缩进
          按下 n> 向后缩进

* 在正常模式下：

          n << 键向前缩进从当前起及之后的n-1行
          n >> 键向后缩进从当前起及之后的n-1行
> n 表示要缩进的次数，缩进一次可以省略。

* 命令行模式下：

          m,n> m 到 n 行缩进
          m>n m行开始的n 行缩进一次


### <a id="vimcmd_other">其他</a>
#### 基本计算器
插入模式下，按 Ctrl+r 键然后输入 =，再输入一个简单的算式(如：=2+3)，再按 Enter 键计算结果会被插入到文件中。

#### 缩写
:ab [缩写] [要替换的文字]

    ab asap as soon as possible

#### 忘记用 root 方式打开文件时的文件保存

    :w !sudo tee %
    
#### 实时加密文本

    ggVGg?
撤销命令：u

#### 自动补全

    Ctrl+n

#### set 命令

    set autoindent  在插入模式下，对每行按与上行同样的标准进行缩进，与shiftwidth选项结合使用
    set list  把制表符显示为^I ,用$标示行尾（使用list分辨尾部的字符是tab还是空格）
    set number  显示行号
    set readonly  文件只读，除非使用！可写
    set shiftwidth  反向制表符中的空格数目
    set showmatch  在vi中输入），}时，光标会暂时的回到相匹配的（，{   （如果没有相匹配的就发出错误信息的铃声），编程时很有用
    set tabstop  指定tab缩进的字符数目
    set wrapscan  授索在文件的两端绕回
    set 显示设置的所有选项
    set all 显示所有可以设置的选项


> set 设置可以在命令行输入，也可以写在$HOME下的.exrc (如果是vi)或者.vimrc(如果是vim)中。写进去很方便的。

#### cit 命令    
在用vim编辑html和xml时经常使用 cit 操作来删除一对标签内的文字。

#### 常用命令
     %  跳转到配对的括号去
     [[ 跳转到代码块的开头去(但要求代码块中'{'必须单独占一行)
     gD 跳转到局部变量的定义处
     '' 跳转到光标上次停靠的地方, 是两个', 而不是一个"
     mx 设置书签,x只能是a-z的26个字母
     `x 跳转到书签处("`"是1左边的键)
     >  增加缩进,"x>"表示增加以下x行的缩进
     <  减少缩进,"x<"表示减少以下x行的缩进
